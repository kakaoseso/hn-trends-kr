---
title: "Linux Kernel Scheduling with Astrology: When Mercury Retrograde Hits Your Latency"
description: "Linux Kernel Scheduling with Astrology: When Mercury Retrograde Hits Your Latency"
pubDate: "2026-02-03T10:57:51Z"
---

## CPU 스케줄링, 이제 우주(Cosmos)에 맡기세요

우리는 지난 수십 년간 리눅스 커널의 CPU 스케줄러를 두고 치열한 논쟁을 벌여왔습니다. O(1)부터 CFS(Completely Fair Scheduler), 그리고 최근의 EEVDF(Earliest Eligible Virtual Deadline First)까지. 모든 엔지니어의 목표는 단 하나, **Latency** 와 **Throughput** 사이의 완벽한 균형점을 찾는 것이었죠.

그런데, 우리가 중요한 변수를 놓치고 있었다면 어떨까요? 바로 **행성의 위치** 와 **별자리** 입니다.

농담처럼 들리겠지만, 오늘 소개할 프로젝트는 실제로 동작하는 리눅스 커널 스케줄러입니다. 이름하여 `scx_horoscope`. 점성술(Astrology)에 기반해 CPU 타임 슬라이스를 결정합니다. "수성 역행(Mercury Retrograde)" 기간에는 네트워크 패킷 처리가 느려지고, 보름달이 뜨면 쉘(Shell) 반응 속도가 빨라집니다.

이 프로젝트는 단순한 장난처럼 보이지만, 그 이면에는 리눅스 커널 6.12에 도입된 `sched_ext`라는 강력한 기술적 변화가 숨어 있습니다. 오늘은 이 황당하고도 천재적인 프로젝트를 통해 **User-space Scheduling** 의 미래를 진지하게 들여다보겠습니다.

---

### 기술적 구현: 농담을 코드로 실현하다

이 프로젝트는 GitHub 유저 `zampierilucas`가 만든 것으로, Rust로 작성되었습니다. 핵심은 리눅스의 `sched_ext` (BPF 기반 확장 스케줄러 프레임워크)를 사용하여 커널의 스케줄링 로직을 유저스페이스로 끌어올린 것입니다.

작동 원리는 꽤나 구체적이고 "과학적(?)"입니다:

- **행성 계산:** `astro` crate를 사용하여 실시간으로 행성의 지구중심 좌표(Geocentric planetary positions)를 계산합니다.
- **Task 분류:** 프로세스들은 그 성격에 따라 수호성(Planet)이 정해집니다.
    - `PID 1` (Init): **태양** (생명력)
    - `Shell/Editor`: **달** (감정/반응성)
    - `Network/IO`: **수성** (의사소통)
    - `Compiler/Encoding`: **화성** (에너지/전쟁)
- **버프와 디버프:** 현재 별자리의 원소(불, 물, 공기, 흙)와 태스크의 상성에 따라 CPU Time Slice가 조정됩니다.
    - **불(Fire)의 별자리** 기간에는 CPU 집중 작업(화성)이 1.5배 부스트를 받습니다.
    - 반면, **물(Water)의 별자리** 기간에는 불의 기운이 꺼지며 CPU 작업이 0.6배로 느려집니다.

가장 압권인 기능은 **역행(Retrograde) 감지** 입니다. 행성이 겉보기 운동으로 뒤로 가는 것처럼 보이는 시기에는, 해당 행성이 관장하는 프로세스들이 **50%의 Time Slice 페널티** 를 받습니다. 수성이 역행하면? 여러분의 네트워크 데몬들이 "우주의 기운" 때문에 느려지는 겁니다.

### `sched_ext`: 장난감 그 이상의 의미

이 프로젝트를 보고 단순히 "재밌네" 하고 넘어가면 하수입니다. 시니어 엔지니어라면 여기서 **sched_ext** 의 잠재력을 봐야 합니다.

과거에는 커널 스케줄러를 수정하려면 커널 코드를 직접 패치하고 재컴파일해야 했습니다. 실수하면 바로 Kernel Panic이었죠. 하지만 `sched_ext`는 BPF(eBPF)를 통해 안전하게 스케줄링 정책을 유저스페이스 프로그램으로 구현할 수 있게 해줍니다.

`scx_horoscope`가 시사하는 바는 명확합니다:

1.  **Domain-Specific Scheduling:** 이제 범용 스케줄러(CFS, EEVDF)에 의존할 필요 없이, 특정 워크로드(데이터베이스, 게이밍, 실시간 통신 등)에 특화된 스케줄러를 쉽게 작성하고 교체할 수 있습니다.
2.  **Rapid Prototyping:** Rust로 로직을 짜서 바로 커널에 로드할 수 있습니다. 점성술 로직을 넣을 수 있다는 건, 머신러닝 모델이나 아주 복잡한 휴리스틱도 넣을 수 있다는 뜻입니다.
3.  **Stability:** 스케줄러 로직이 꼬여도 커널 전체가 죽는 대신 기본 스케줄러로 폴백(Fallback)할 수 있는 안전장치들이 마련되고 있습니다.

### Hacker News의 반응: 심즈(The Sims)와 플라시보

이 프로젝트에 대한 Hacker News의 반응은 폭발적이었습니다. 그중에서도 제 눈길을 끈 것은 **심즈(The Sims)** 개발에 얽힌 일화였습니다.

> "심즈 개발 초기, 윌 라이트(Will Wright)는 캐릭터 성격에 별자리를 도입했습니다. 하지만 실제로는 별자리가 행동에 아무런 영향을 주지 않도록 코드를 짰죠. 그런데 테스터들이 버그 리포트를 보내기 시작했습니다. '별자리 영향이 너무 강해요! 좀 줄여주세요!'라고요. 유저들은 시뮬레이션되지 않은 것을 스스로 상상해 채워 넣었습니다."

이것은 엔지니어링에서 **"Observability"** 와 **"Mental Model"** 이 얼마나 중요한지 보여줍니다. 우리는 종종 시스템의 복잡성을 과대평가하거나, 우연한 레이턴시 스파이크를 "네트워크가 오늘따라 기분이 안 좋네"라고 의인화합니다. `scx_horoscope`는 이 의인화를 실제 코드로 구현해버린 셈입니다.

또한, 어떤 유저는 이를 두고 "결정론적 카오스 몽키(Deterministic Chaos Monkey)"라고 평했습니다. 넷플릭스의 카오스 몽키가 무작위로 서버를 끈다면, 이 스케줄러는 행성의 위치라는 예측 가능한(하지만 인간에겐 무작위처럼 느껴지는) 변수로 시스템에 부하를 줍니다. 테스트 환경에서 예측 불가능한 지연을 시뮬레이션하기 위한 도구로써... 쓸 수도 있지 않을까요? (물론 농담입니다.)

### 결론: 별들에게 물어봐 (하지만 프로덕션은 말고)

솔직히 말해서, 저는 이 프로젝트가 너무 마음에 듭니다. 기술적 허세와 유머가 완벽하게 결합되어 있습니다. "내 컴파일이 느린 이유는 코드가 나빠서가 아니라, 화성이 역행 중이라서 그래"라고 핑계를 댈 수 있게 해 주니까요.

하지만 진지하게, **`sched_ext`는 리눅스 성능 튜닝의 판도를 바꿀 기술** 입니다. 구글이나 메타 같은 하이퍼스케일러들은 이미 자신들의 워크로드에 맞는 커스텀 스케줄러를 만지작거리고 있을 겁니다. `scx_horoscope`는 그 거대한 변화의 파도를 가장 유쾌한 방식으로 서핑하는 프로젝트입니다.

만약 여러분이 NixOS를 쓰고 있고 커널 6.12 이상을 돌린다면, 한 번쯤 재미로 로드해 보세요. 단, 프로덕션 서버에는 절대 올리지 마십시오. 장애 보고서에 "원인: 수성 역행으로 인한 DB 쿼리 타임아웃"이라고 적고 싶지 않다면 말이죠.

**Verdict:**
- **실용성:** 0/5 (점성술을 믿으신다면 5/5)
- **기술적 가치:** 5/5 (`sched_ext`의 훌륭한 데모)
- **재미:** 5/5 (우주적 스케일의 농담)
